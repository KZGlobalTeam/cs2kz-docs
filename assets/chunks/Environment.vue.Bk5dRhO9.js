import{d as W,p as y,h as X,q as L,o as d,c as z,e as j,F as U,n as g,N as F,b as w,k as u,C as T,j as x,ay as ee,az as xe,G as m,P as he,w as b,t as G,a as J,v as Ce,Y as ke,Z as ye,aA as ge,aC as we}from"./framework.D4KI3xLP.js";import{J as N,U as q,D as le,B as Ee,$ as K,V as oe,G as _e,ac as $e,F as Ie,aC as A,_ as Se,aJ as je}from"../api_explorer.md.GsGzUyls.js";import{C as ze}from"./EditSidebarListElement.vue.DzD2MEZB.js";import{e as Ve,m as De,g as Ne,a as Me}from"./DeleteSidebarListElement.vue.B1JUgoQh.js";import{_ as Be,f as Q}from"./SidebarListElement.vue.C4aktEyF.js";import{x as Re,a as Oe}from"./ViewLayoutContent.vue.CCvsHqn-.js";import{d as Fe}from"./LibraryIcon.vue.D9EnEb4o.js";import{h as Ue,b as We}from"./CommandActionInput.vue.DRpbYwmp.js";const Pe=["onClick"],Ae=["placeholder"],ae=W({__name:"EnvironmentColors",props:{activeColor:{},selector:{type:Boolean,default:!1}},emits:["select"],setup(M,{emit:E}){const s=M,k=E,f=y(""),c=y(null),C=y(!1),h=y(!1),i=[{color:"#8E8E8E"},{color:"#EF0006"},{color:"#EDBE20"},{color:"#069061"},{color:"#FB892C"},{color:"#0082D0"},{color:"#5203D1"},{color:"#FFC0CB"}],_=X(()=>s.activeColor&&!i.some(a=>a.color===s.activeColor)||f.value?`background-color: ${s.activeColor||f.value};`:"background: linear-gradient(to right, rgb(235, 87, 87), rgb(242, 201, 76), rgb(76, 183, 130), rgb(78, 167, 252), rgb(250, 96, 122));"),$=()=>{C.value=!C.value,s.selector&&(h.value=!1),he(()=>{c.value&&c.value.focus()})};L(f,a=>{a&&!a.startsWith("#")&&(f.value=`#${a}`),C.value=!0});const V=()=>{s.selector&&(h.value=!h.value)},I=a=>{k("select",a),s.selector&&(h.value=!1)};return(a,r)=>(d(),z("div",null,[C.value?j("",!0):(d(),z(U,{key:0},[s.selector&&!h.value?(d(),z("div",{key:0,class:g(["flex cursor-pointer items-center justify-center rounded-full",s.selector?"h-4 w-4":"h-5 w-5"]),style:F({backgroundColor:a.activeColor}),onClick:V},[a.activeColor?(d(),w(u(N),{key:0,class:g(["text-c-btn",s.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):j("",!0)],6)):j("",!0),h.value||!s.selector?(d(),z("div",{key:1,class:g(["color-selector flex flex-row gap-1.5 items-center justify-between space-x-1",s.selector?"h-4":"min-h-10 min-w-[296px]"])},[(d(),z(U,null,T(i,t=>x("div",{key:t.color,class:g(["flex cursor-pointer items-center justify-center rounded-full",s.selector?"h-4 w-4":"h-5 w-5"]),style:F({backgroundColor:t.color}),onClick:B=>I(t.color)},[a.activeColor===t.color&&!f.value?(d(),w(u(N),{key:0,class:g(["text-c-btn",s.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):j("",!0)],14,Pe)),64)),r[2]||(r[2]=x("hr",{class:"w-0.5 h-5 border-ghost border-l"},null,-1)),x("label",{class:g(["cursor-pointer flex flex-row justify-center gap-2 items-center rounded-full z-10",s.selector?"h-4 w-4":"h-5 w-5"]),style:F(_.value),onClick:$},[!C.value&&(a.activeColor===f.value||a.activeColor&&!i.some(t=>t.color===a.activeColor))?(d(),w(u(N),{key:0,class:"text-c-btn",icon:"Checkmark",size:"xs"})):j("",!0)],6)],2)):j("",!0)],64)),C.value?(d(),z("div",{key:1,class:g(["color-selector flex flex-1 gap-2 items-center rounded",s.selector?"h-4":"min-h-10"])},[x("span",{class:g(["absolute border border-dashed rounded-full",s.selector?"h-4 w-4":"h-5 w-5"])},null,2),x("span",{class:g(["rounded-full z-[1]",s.selector?"h-4 w-4":"h-5 w-5"]),style:F(_.value)},null,6),ee(x("input",{ref_key:"customColorInputRef",ref:c,"onUpdate:modelValue":r[0]||(r[0]=t=>f.value=t),class:"border-transparent flex-1 outline-none w-full text-sm",placeholder:a.activeColor||"#000000",type:"text",onInput:r[1]||(r[1]=t=>I(f.value))},null,40,Ae),[[xe,f.value]]),x("button",{class:"text-c-3 hover:bg-b-2 p-1.5 rounded-lg",type:"button",onClick:$},[m(u(N),{icon:"Checkmark",size:"xs"})])],2)):j("",!0)]))}}),Te={class:"flex flex-col gap-4"},Ge=W({__name:"EnvironmentColorModal",props:{state:{},selectedColor:{}},emits:["cancel","submit"],setup(M,{emit:E}){const s=M,k=E,f=y(""),c=h=>{f.value=h},C=()=>{k("submit",f.value),f.value=""};return(h,i)=>(d(),w(u(q),{size:"xxs",state:h.state,title:"Edit Environment Color"},{default:b(()=>[x("div",Te,[m(ae,{activeColor:f.value||s.selectedColor,class:"p-1 w-full",onSelect:c},null,8,["activeColor"]),m(Ve,{onCancel:i[0]||(i[0]=_=>k("cancel")),onSubmit:C})])]),_:1},8,["state"]))}}),Je={class:"flex gap-2 items-start"},Ke=W({__name:"EnvironmentModal",props:{state:{},activeWorkspaceCollections:{},collectionId:{}},emits:["cancel","submit"],setup(M,{emit:E}){const s=M,k=E,{events:f}=le(),c=y(""),C=y("#8E8E8E"),h=X(()=>[...s.activeWorkspaceCollections.filter(a=>{var r;return((r=a.info)==null?void 0:r.title)!=="Drafts"}).map(a=>{var r;return{id:a.uid,label:((r=a.info)==null?void 0:r.title)??"Untitled Collection"}})]),i=y(h.value.find(a=>a.id===s.collectionId)),{toast:_}=oe(),$=a=>{C.value=a};L(()=>s.state.open,a=>{a&&(c.value="",C.value="#8E8E8E",s.collectionId?i.value=h.value.find(r=>r.id===s.collectionId):i.value=void 0)});const V=()=>{var a,r,t,B;if(!((a=i.value)!=null&&a.id)){_("Please select a collection before adding an environment.","error");return}k("submit",{name:c.value,color:C.value,type:((r=i.value)==null?void 0:r.id)==="global"?"global":"collection",collectionId:((t=i.value)==null?void 0:t.id)!=="global"?(B=i.value)==null?void 0:B.id:void 0})},I=()=>{s.state.hide(),f.commandPalette.emit({commandName:"Create Collection"})};return(a,r)=>(d(),w(u(q),{bodyClass:"border-t-0 rounded-t-lg",size:"xs",state:a.state},{default:b(()=>[m(Ue,{disabled:!i.value,onCancel:r[2]||(r[2]=t=>k("cancel")),onSubmit:V},{options:b(()=>[m(u(Ee),{modelValue:i.value,"onUpdate:modelValue":r[1]||(r[1]=t=>i.value=t),options:h.value,placeholder:"Select Type"},{default:b(()=>[h.value.length>0?(d(),w(u(K),{key:0,class:"justify-between p-2 max-h-8 w-full gap-1 text-xs hover:bg-b-2 w-fit",variant:"outlined"},{default:b(()=>[x("span",{class:g(i.value?"text-c-1":"text-c-3")},G(i.value?i.value.label:"Select Collection"),3),m(u(N),{class:"text-c-3",icon:"ChevronDown",size:"xs"})]),_:1})):(d(),w(u(K),{key:1,class:"justify-between p-2 max-h-8 gap-1 text-xs hover:bg-b-2",variant:"outlined",onClick:I},{default:b(()=>r[3]||(r[3]=[x("span",{class:"text-c-1"},"Create Collection",-1)])),_:1}))]),_:1},8,["modelValue","options"])]),submit:b(()=>r[4]||(r[4]=[J("Add Environment")])),default:b(()=>[x("div",Je,[m(ae,{activeColor:C.value,class:"peer",selector:"",onSelect:$},null,8,["activeColor"]),m(We,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=t=>c.value=t),class:"!p-0 peer-has-[.color-selector]:hidden -mt-[.5px]",placeholder:"Environment name"},null,8,["modelValue"])])]),_:1},8,["disabled"])]),_:1},8,["state"]))}}),Le={class:"flex-1"},qe=["onClick"],Ye={class:"flex h-5 items-center justify-center max-w-[14px]"},tl=W({__name:"Environment",setup(M){const E=_e(),s=$e(),{activeWorkspace:k,activeEnvironment:f,activeWorkspaceCollections:c}=Ie(),{events:C,workspaceMutators:h,collectionMutators:i}=le(),{collapsedSidebarFolders:_,toggleSidebarFolder:$}=je(),V=A(),I=A(),a=A(),r=y(null),t=y("default"),B=y(""),R=y(void 0),S=y(void 0),O=y(void 0),{toast:Y}=oe(),te=l=>JSON.parse(l);function Z(l,o,e){var n;l&&(o.uid===e?Y(`Environment name already used in ${(n=o.info)==null?void 0:n.title}`,"error"):Y("Environment name already used in another collection","error"))}function ne(l){c.value.some(o=>{const e=Object.keys(o["x-scalar-environments"]||{}).includes(l.name);return Z(e,o,l.collectionId),e})||(l.collectionId&&(i.addEnvironment(l.name,{variables:{},color:l.color},l.collectionId),_[l.collectionId]||$(l.collectionId),E.push({name:"environment.collection",params:{collectionId:l.collectionId,environmentId:l.name}})),I.hide())}function se(l){var o,e;if(f){const n=te(l);if(t.value==="default")h.edit(((o=k.value)==null?void 0:o.uid)??"","environments",n);else{const p=c.value.find(v=>{var D;return(D=v["x-scalar-environments"])==null?void 0:D[t.value??""]});if((e=p==null?void 0:p["x-scalar-environments"])!=null&&e[t.value??""]){const v=p["x-scalar-environments"][t.value??""];v&&(v.variables=n,i.edit(p.uid,"x-scalar-environments",p["x-scalar-environments"]))}}}}const P=l=>{R.value=l,I.show()},re=(l,o)=>{S.value=l,R.value=o,O.value=l,a.show()},ie=l=>{var o,e,n;r.value=l,B.value=((n=(e=(o=c.value.find(p=>{var v;return(v=p["x-scalar-environments"])==null?void 0:v[l]}))==null?void 0:o["x-scalar-environments"])==null?void 0:e[l])==null?void 0:n.color)??"",V.show()},ce=l=>{const o=r.value;typeof o=="string"&&(c.value.some(e=>{var n;return(n=e["x-scalar-environments"])==null?void 0:n[o]})&&c.value.forEach(e=>{var n;(n=e["x-scalar-environments"])!=null&&n[o]&&(e["x-scalar-environments"][o].color=l,i.edit(e.uid,"x-scalar-environments",e["x-scalar-environments"]))}),V.hide())};function ue(l){c.value.forEach(e=>{i.removeEnvironment(l,e.uid)});const o=c.value.flatMap(e=>Object.keys(e["x-scalar-environments"]||{}));if(o.length>0){const e=o[o.length-1];if(!e)return;const n=c.value.find(p=>Object.keys(p["x-scalar-environments"]||{}).includes(e));t.value=e,E.push({name:"environment.collection",params:{collectionId:n==null?void 0:n.uid,environmentId:e}}),n&&!_[n.uid]&&$(n.uid)}else t.value="default",E.push({name:"environment",params:{environment:"default"}})}const ve=()=>t.value==="default"?"Global Environment":t.value,de=()=>{var l,o,e,n;return t.value==="default"?JSON.stringify((l=k.value)==null?void 0:l.environments,null,2):JSON.stringify((n=(e=(o=c.value.find(p=>{var v;return(v=p["x-scalar-environments"])==null?void 0:v[t.value??""]}))==null?void 0:o["x-scalar-environments"])==null?void 0:e[t.value??""])==null?void 0:n.variables,null,2)},me=l=>_[l],H=l=>{l!=null&&l.createNew&&s.name==="environment"&&P()};L(()=>[s.params.collectionId,s.params.environmentId],([l,o])=>{l?t.value=o:t.value="default"}),Ce(()=>{t.value=s.params.environmentId||"default",C.hotKeys.on(H);const{collectionId:l}=E.currentRoute.value.params;l&&!_[l]&&$(l)}),ke(()=>C.hotKeys.off(H));const fe=(l,o,e)=>{var n,p;const v=e?`/workspace/${(n=k==null?void 0:k.value)==null?void 0:n.uid}/environment/${e}/${o}`:`/workspace/${(p=k==null?void 0:k.value)==null?void 0:p.uid}/environment/${o}`;l.metaKey?window.open(v,"_blank"):E.push({path:v})};function pe(){S.value=void 0,R.value=void 0,O.value=void 0,a.hide()}function be(l){c.value.some(o=>{const e=Object.keys(o["x-scalar-environments"]||{}).includes(l);return Z(e,o,R.value),e})||(l&&S.value!=="default"&&c.value.forEach(o=>{var e;if((e=o["x-scalar-environments"])!=null&&e[S.value??""]){const n=o["x-scalar-environments"][S.value??""];n&&(delete o["x-scalar-environments"][S.value??""],o["x-scalar-environments"][l]=n,i.edit(o.uid,"x-scalar-environments",o["x-scalar-environments"]))}}),l&&t.value===S.value&&(t.value=l),S.value=void 0,R.value=void 0,O.value=void 0,a.hide())}return(l,o)=>(d(),w(Oe,null,{default:b(()=>[m(De,{title:"Collections"},{content:b(()=>[x("div",Le,[m(Be,null,{default:b(()=>[(d(),w(Q,{key:"default",class:"text-xs",isCopyable:!1,type:"environment",variable:{name:"Global Environment",uid:"default",icon:"Globe",isDefault:!0}})),(d(!0),z(U,null,T(u(c),e=>{var n;return d(),z("li",{key:e.uid,class:"flex flex-col gap-0.25"},[x("button",{class:"flex font-medium gap-1.5 group items-center p-1.5 text-left text-sm w-full break-words rounded hover:bg-b-2",type:"button",onClick:p=>u($)(e.uid)},[x("span",Ye,[m(u(Fe),{class:"min-w-3.5 text-sidebar-c-2 size-3.5 stroke-2 group-hover:hidden",src:e["x-scalar-icon"]||"interface-content-folder"},null,8,["src"]),x("div",{class:g({"rotate-90":u(_)[e.uid]})},[m(u(N),{class:"text-c-3 hidden text-sm group-hover:block",icon:"ChevronRight",size:"md"})],2)]),J(" "+G(((n=e.info)==null?void 0:n.title)??""),1)],8,qe),ee(x("div",{class:g({"before:bg-border before:pointer-events-none before:z-1 before:absolute before:left-3 before:top-0 before:h-[calc(100%_+_.5px)] last:before:h-full before:w-[.5px] mb-[.5px] last:mb-0 relative":Object.keys(e["x-scalar-environments"]||{}).length>0})},[(d(!0),z(U,null,T(e["x-scalar-environments"],(p,v)=>(d(),w(Q,{key:v,class:"text-xs [&>a]:pl-5",collectionId:e.uid,isCopyable:!1,isDeletable:!0,isRenameable:!0,type:"environment",variable:{name:v,uid:v,color:p.color??"#8E8E8E",isDefault:!1},warningMessage:"Are you sure you want to delete this environment?",onClick:ye(D=>fe(D,v,e.uid),["prevent"]),onColorModal:D=>ie(v),onDelete:D=>ue(v),onRename:D=>re(v,e.uid)},null,8,["collectionId","variable","onClick","onColorModal","onDelete","onRename"]))),128)),Object.keys(e["x-scalar-environments"]||{}).length===0?(d(),w(u(K),{key:0,class:"mb-[.5px] flex gap-1.5 h-8 text-c-1 pl-6 py-0 justify-start text-xs w-full hover:bg-b-2",variant:"ghost",onClick:p=>P(e.uid)},{default:b(()=>[m(u(N),{class:"ml-0.5 h-2.5 w-2.5",icon:"Add",thickness:"3"}),o[2]||(o[2]=x("span",null,"Add Environment",-1))]),_:2},1032,["onClick"])):j("",!0)],2),[[ge,me(e.uid)]])])}),128))]),_:1})])]),button:b(()=>[m(Ne,{click:P,hotkey:"N"},{title:b(()=>o[3]||(o[3]=[J("Add Environment")])),_:1})]),_:1}),m(Re,{class:"flex-1"},{default:b(()=>[m(Me,null,we({default:b(()=>[t.value?(d(),w(Se,{key:0,class:"border-t pl-px pr-2 md:px-4 py-2",isCopyable:"",language:"json",lineNumbers:"",lint:"",modelValue:de(),"onUpdate:modelValue":se},null,8,["modelValue"])):j("",!0)]),_:2},[t.value?{name:"title",fn:b(()=>[x("span",null,G(ve()),1)]),key:"0"}:void 0]),1024)]),_:1}),m(Ge,{selectedColor:B.value,state:u(V),onCancel:o[0]||(o[0]=e=>u(V).hide()),onSubmit:ce},null,8,["selectedColor","state"]),m(Ke,{activeWorkspaceCollections:u(c),collectionId:R.value,state:u(I),onCancel:o[1]||(o[1]=e=>u(I).hide()),onSubmit:ne},null,8,["activeWorkspaceCollections","collectionId","state"]),m(u(q),{size:"xxs",state:u(a),title:`Edit ${S.value}`},{default:b(()=>[m(ze,{name:O.value??"",onClose:pe,onEdit:be},null,8,["name"])]),_:1},8,["state","title"])]),_:1}))}});export{tl as default};
