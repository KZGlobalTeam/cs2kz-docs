import{d as z,h as b,o,c as x,b as p,e as A,w as c,G as n,k as s,j as d,F as U,C as D,n as I,t as W,Z as G,ay as J,aA as q,a as K}from"./framework.D4KI3xLP.js";import{a as T}from"./EmptyState.vue.C-LutM_T.js";import{m as Z,g as H}from"./DeleteSidebarListElement.vue.4grbQCss.js";import{_ as Q,f as X}from"./SidebarListElement.vue.pl763XuU.js";import{x as Y,a as ee}from"./ViewLayoutContent.vue.CELOTxKz.js";import{F as B,D as F,G as le,ac as te,J as w,$ as j,aJ as re}from"../api_explorer.md.DF3uy-io.js";import{d as ae}from"./LibraryIcon.vue.D9EnEb4o.js";import{E as se}from"./Form.vue.QfYM3zmZ.js";const oe={class:"divide-0.5 divide-x flex w-full"},ie=z({__name:"ServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(_){const u=_,{activeWorkspaceCollections:f}=B(),{servers:h,serverMutators:k}=F(),g=[{label:"URL",key:"url",placeholder:"https://void.scalar.com/api"},{label:"Label",key:"description",placeholder:"Production"}],v=b(()=>{const t=f.value.find(i=>i.uid===u.collectionId);return h[t&&typeof u.serverUid=="string"&&u.serverUid==="default"?t.servers[0]??"":(t==null?void 0:t.servers.find(i=>i===u.serverUid))??""]}),y=(t,i)=>{!f.value||!v.value||k.edit(v.value.uid,t,i)};return(t,i)=>(o(),x("div",oe,[v.value?(o(),p(se,{key:0,data:v.value,onUpdate:y,options:g,title:"Server"},null,8,["data"])):A("",!0)]))}}),ne={class:"flex-1"},ce=["onClick"],de={class:"flex h-5 items-center justify-center max-w-[14px] pr-px"},ue={class:"break-all line-clamp-1 font-medium text-left w-full"},ge=z({__name:"Servers",setup(_){const{activeWorkspaceCollections:u,activeWorkspace:f,activeCollection:h}=B(),{servers:k,events:g,serverMutators:v}=F(),{push:y}=le(),t=te(),{collapsedSidebarFolders:i,toggleSidebarFolder:N}=re(),$=b(()=>t.params.collectionId),V=b(()=>t.params.servers),L=r=>i[r];function C(r){g.commandPalette.emit({commandName:"Add Server",metaData:{parentUid:r}})}const R=b(()=>u.value.filter(r=>{var l;return((l=r.info)==null?void 0:l.title)!=="Drafts"})),E=(r,l,e)=>{var m;const a=`/workspace/${(m=f==null?void 0:f.value)==null?void 0:m.uid}/servers/${e}/${l}`;r.metaKey?window.open(a,"_blank"):y({path:a})};function M(r){var l;(l=h==null?void 0:h.value)!=null&&l.uid&&v.delete(r,$.value)}const O=b(()=>Object.keys(k).length>0);return(r,l)=>(o(),p(ee,null,{default:c(()=>[n(s(Z),{title:"Servers"},{content:c(()=>[d("div",ne,[n(Q,null,{default:c(()=>[(o(!0),x(U,null,D(R.value,e=>{var m;return o(),x("li",{key:e.uid,class:"flex flex-col gap-1/2"},[d("button",{class:"flex font-medium gap-1.5 group items-center p-1.5 text-left text-sm w-full break-words rounded hover:bg-b-2",type:"button",onClick:a=>s(N)(e.uid)},[d("span",de,[n(s(ae),{class:"min-w-3.5 text-sidebar-c-2 size-3.5 stroke-2 group-hover:hidden",src:e["x-scalar-icon"]||"interface-content-folder"},null,8,["src"]),d("div",{class:I({"rotate-90":s(i)[e.uid]})},[n(s(w),{class:"text-c-3 hidden text-sm group-hover:block",icon:"ChevronRight",size:"md"})],2)]),d("span",ue,W(((m=e.info)==null?void 0:m.title)??""),1),n(s(j),{class:"hidden group-hover:block px-0.5 py-0 hover:bg-b-3 hover:text-c-1 group-focus-visible:opacity-100 group-has-[:focus-visible]:opacity-100 aspect-square h-fit",size:"sm",variant:"ghost",onClick:G(a=>C(e.uid),["stop","prevent"])},{default:c(()=>[n(s(w),{icon:"Add",size:"md",thickness:"2"})]),_:2},1032,["onClick"])],8,ce),J(d("div",{class:I({"before:bg-border before:pointer-events-none before:z-1 before:absolute before:left-3 before:top-0 before:h-[calc(100%_+_.5px)] last:before:h-full before:w-[.5px] flex flex-col gap-1/2 mb-[.5px] last:mb-0 relative":Object.keys(e.servers||{}).length>0})},[(o(!0),x(U,null,D(e.servers,a=>{var S;return o(),p(X,{key:a,class:"[&>a]:pl-[1.625rem]",collectionId:e.uid,isDeletable:!0,type:"servers",variable:{name:((S=s(k)[a])==null?void 0:S.url)??"",uid:a},onClick:P=>E(P,a,e.uid),onDelete:M},null,8,["collectionId","variable","onClick"])}),128)),Object.keys(e.servers||{}).length===0?(o(),p(s(j),{key:0,class:"mb-[.5px] flex gap-1.5 h-8 text-c-1 pl-6 py-0 justify-start text-xs w-full hover:bg-b-2",variant:"ghost",onClick:a=>C(e.uid)},{default:c(()=>[n(s(w),{class:"ml-0.5 h-2.5 w-2.5",icon:"Add",thickness:"3"}),l[0]||(l[0]=d("span",null,"Add Server",-1))]),_:2},1032,["onClick"])):A("",!0)],2),[[q,L(e.uid)]])])}),128))]),_:1})])]),button:c(()=>[n(H,{click:C},{title:c(()=>l[1]||(l[1]=[K("Add Server")])),_:1})]),_:1}),n(Y,{class:"flex-1"},{default:c(()=>[O.value?(o(),p(ie,{key:0,collectionId:$.value,serverUid:V.value},null,8,["collectionId","serverUid"])):(o(),p(T,{key:1}))]),_:1})]),_:1}))}});export{ge as default};
